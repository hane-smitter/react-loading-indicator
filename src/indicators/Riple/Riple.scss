@use "sass:string";
@use "../../scss/variables" as defaults;

$animationDuration: var(--rli-animation-duration, 1s);
$animationFn: var(--rli-animation-function, cubic-bezier(0, 0.2, 0.8, 1));

$rippling: string.unique-id();
$rippleColoring: string.unique-id();

@function ripleColorVar($num: null) {
	$cssVar: var(--riple-phase1-color);

	@if ($num and $num != 1) {
		$cssVar: var(--riple-phase#{$num}-color, $cssVar);
	}

	@return $cssVar;
}

.riple-rli-bounding-box {
	--riple-phase1-color: #{defaults.$defaultColor};

	box-sizing: border-box;
	font-size: defaults.$fontSizer;
	display: inline-block;
	color: ripleColorVar();

	.riple-indicator {
		display: inline-block;
		width: 5em;
		height: 5em;
		// color: defaults.$defaultColor;
		// background-color: gray;

		// Create stacking context
		position: relative;
		z-index: 0;

		.riple-text {
			mix-blend-mode: difference;
			// filter: invert(1);

			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);

			z-index: -2;
		}

		.riple {
			--border-width: 0.25em;
			position: absolute;
			border: var(--border-width) solid ripleColorVar();
			opacity: 1;
			border-radius: 50%;
			animation:
				$rippling $animationDuration $animationFn infinite,
				$rippleColoring calc($animationDuration * 4) $animationFn infinite;
		}
		.riple:nth-of-type(2) {
			// animation-delay: -0.5s;
			animation-delay: calc($animationDuration / 2 * -1);
		}
	}
}

@keyframes #{$rippling} {
	0% {
		top: calc(50% - var(--border-width));
		left: calc(50% - var(--border-width));
		right: calc(50% - var(--border-width));
		bottom: calc(50% - var(--border-width));
		opacity: 0;
	}
	4.9% {
		top: calc(50% - var(--border-width));
		left: calc(50% - var(--border-width));
		right: calc(50% - var(--border-width));
		bottom: calc(50% - var(--border-width));
		opacity: 0;
	}
	5% {
		top: calc(50% - var(--border-width));
		left: calc(50% - var(--border-width));
		right: calc(50% - var(--border-width));
		bottom: calc(50% - var(--border-width));
		opacity: 1;
	}
	100% {
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		opacity: 0;
	}
}

@keyframes #{$rippleColoring } {
	100%,
	0% {
		border-color: ripleColorVar(1);
	}
	24.9% {
		border-color: ripleColorVar(1);
	}
	25% {
		border-color: ripleColorVar(2);
	}
	49.9% {
		border-color: ripleColorVar(2);
	}
	50% {
		border-color: ripleColorVar(3);
	}
	74.9% {
		border-color: ripleColorVar(3);
	}
	75% {
		border-color: ripleColorVar(4);
	}
	99.9% {
		border-color: ripleColorVar(4);
	}
}
