@use "sass:color";
@use "../../scss/variables" as defaults;

$defaultColorRedChannel: color.red(defaults.$defaultColor);
$defaultColorGreenChannel: color.green(defaults.$defaultColor);
$defaultColorBlueChannel: color.blue(defaults.$defaultColor);
$spinAtomDuration: 2.5s;
$spinAtomPathDuration: 8s;
$colorInversionDegree: 255; // 0 - 255

.atom-bounding-box {
  --color-r: #{$defaultColorRedChannel};
  --color-g: #{$defaultColorGreenChannel};
  --color-b: #{$defaultColorBlueChannel};

  font-size: defaults.$fontSizer;
  position: relative;
  color: rgb(var(--color-r), var(--color-g), var(--color-b));

  // Create stacking context
  isolation: isolate;

  .atom-loader {
    $box-width: 4em;
    $box-height: 4em;

    // create stacking context + relative positioning
    position: relative;
    z-index: 1;

    width: $box-width;
    height: $box-height;
    transform: perspective(500px) rotateX(-24deg) rotateY(20deg) rotateZ(30deg);
    transform-style: preserve-3d;
    // color: $defaultColor;

    & .inner {
      width: 100%;
      height: 100%;
      -webkit-transform-style: preserve-3d;
      transform-style: preserve-3d;
      animation: spinAtom $spinAtomDuration linear infinite;
      display: inline-block;
      transform-origin: center center;
      position: relative;

      & .disc:nth-of-type(1) {
        --disc-color: var(--disc3-color);
        animation: rotate $spinAtomPathDuration linear infinite;
      }
      & .disc:nth-of-type(2) {
        --disc-color: var(--disc2-color);
        animation: rotateDisc2 $spinAtomPathDuration linear infinite;
      }
      & .disc:nth-of-type(3) {
        --disc-color: var(--disc1-color);
        animation: rotateDisc3 $spinAtomPathDuration linear infinite;
      }

      & .disc {
        position: absolute;
        width: 100%;
        height: 98%;
        border-radius: 50%;
        border: 0.3em solid var(--disc-color, currentColor);
        display: inline-block;
      }

      & .disc.nucleus-holder {
        width: $box-width;
        height: $box-height;
        border: 0.3em solid transparent;

        & .nucleus {
          $nucleus-dimension: 0.8em;
          --color-invert-r: calc(#{$colorInversionDegree} - var(--color-r));
          --color-invert-g: calc(#{$colorInversionDegree} - var(--color-g));
          --color-invert-b: calc(#{$colorInversionDegree} - var(--color-b));

          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: $nucleus-dimension;
          height: $nucleus-dimension;
          display: inline-block;
          border-radius: 50%;
          background-color: currentColor;
          // box-shadow: inset 0 0 calc($nucleus-dimension / 6) #fff,
          //   inset calc($nucleus-dimension / 6) 0 calc($nucleus-dimension / 3.75) #f0f,
          //   inset calc($nucleus-dimension / 6 * -1) 0 calc($nucleus-dimension / 3.75) #0ff,
          //   inset calc($nucleus-dimension / 6) 0 $nucleus-dimension #f0f,
          //   inset calc($nucleus-dimension / 6 * -1) 0 $nucleus-dimension #0ff, 0 0 calc($nucleus-dimension / 6) #fff,
          //   calc($nucleus-dimension / 30 * -1) 0 calc($nucleus-dimension / 3.75) #f0f,
          //   calc($nucleus-dimension / 30) 0 calc($nucleus-dimension / 3.75) #0ff;
          box-shadow: inset 0 0 calc($nucleus-dimension / 6) rgba(var(--color-r), var(--color-g), var(--color-b), 0.16),
            inset calc($nucleus-dimension / 6) 0 calc($nucleus-dimension / 3.75)
              rgb(var(--color-invert-r), var(--color-invert-g), var(--color-invert-b), 1),
            inset calc($nucleus-dimension / 6 * -1) 0 calc($nucleus-dimension / 3.75)
              rgb(var(--color-invert-g), var(--color-invert-r), var(--color-invert-b), 1),
            inset calc($nucleus-dimension / 6) 0 $nucleus-dimension
              rgb(var(--color-invert-r), var(--color-invert-g), var(--color-invert-b), 1),
            inset calc($nucleus-dimension / 6 * -1) 0 $nucleus-dimension
              rgb(var(--color-invert-g), var(--color-invert-r), var(--color-invert-b), 1),
            0 0 calc($nucleus-dimension / 6) rgba(var(--color-r), var(--color-g), var(--color-b), 0.16),
            calc($nucleus-dimension / 30 * -1) 0 calc($nucleus-dimension / 1.35)
              rgb(var(--color-invert-r), var(--color-invert-g), var(--color-invert-b), 0.44),
            calc($nucleus-dimension / 30) 0 calc($nucleus-dimension / 1.35)
              rgb(var(--color-invert-g), var(--color-invert-r), var(--color-invert-b), 0.44);
        }
      }
    }
  }

  .atom-text {
    color: currentColor;
    mix-blend-mode: difference;

    position: absolute;
    top: 105%;
    left: 50%;
    transform: translateX(-50%);

    z-index: -2;
  }
}

@keyframes spinAtom {
  0% {
    transform: rotateX(360deg) rotateY(0deg);
  }
  100% {
    transform: rotateX(0deg) rotateY(360deg);
  }
}

@keyframes rotateDisc2 {
  from {
    transform: rotateX(90deg) rotateZ(0deg);
  }
  to {
    transform: rotateX(90deg) rotateZ(360deg);
  }
}
@keyframes rotateDisc3 {
  from {
    transform: rotateY(90deg) rotateZ(0deg);
  }
  to {
    transform: rotateY(90deg) rotateZ(360deg);
  }
}
